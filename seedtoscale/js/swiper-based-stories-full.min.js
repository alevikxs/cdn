// Swiper Based stories.js
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).createStoriesSlider=t()}(this,function(){return function e(t,i={}){let r={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return r.Android()||r.BlackBerry()||r.iOS()||r.Opera()||r.Windows()}},s=r.any(),n=t.querySelector(".swiper"),{autoplayDuration:l=5e3,Swiper:o,EffectCube:a,onSlidesIndexesChange:d,onAutoplayStart:c,onAutoplayStop:u}=i,{enabled:p=!0}=i,f=0,v,h,$=[],y,m,E,g,S,b,A,q,x=(e,t)=>{let i=$.indexOf(e),r=void 0===t?l:t,s=parseInt(e.slides[e.activeIndex].getAttribute("data-duration"),10),n=e.slides[e.activeIndex].querySelector("video");return Number.isNaN(s)&&n&&(s=1e3*n.duration),!Number.isNaN(s)&&s>0&&void 0===t&&(r=s),A=r,e.storiesSliderAutoplayTimeout=setTimeout(()=>{e.isEnd?f===i&&(v.isEnd||v.slideNext()):e.slideNext()},r),c&&c(e),r},w=e=>{clearTimeout(e.storiesSliderAutoplayTimeout),u&&u(e)},T=e=>{w(e);let t=e.slides[e.activeIndex].querySelector("video");t&&(cancelAnimationFrame(h),t.pause());let i=A||l,r=parseInt(e.slides[e.activeIndex].getAttribute("data-duration"),10);if(Number.isNaN(r)&&(r=void 0),!r&&t&&(r=1e3*t.duration),A=i-(new Date().getTime()-b),e.isEnd&&A<0)return;A<0&&(A=0);let s=1-A/(r||l),n=e.el.querySelector(`.stories-slider-pagination-bullet:nth-child(${e.activeIndex+1})`);n.querySelector("span").remove(),n.insertAdjacentHTML("beforeend",`<span style="transform:translateX(${-100+100*s}%)"></span>`)},_=e=>{if(e.isEnd&&A<0)return;b=new Date().getTime(),x(e,A);let t=e.slides[e.activeIndex].querySelector("video");if(t)try{h=requestAnimationFrame(()=>{t.play()})}catch(i){}let r=e.el.querySelector(`.stories-slider-pagination-bullet:nth-child(${e.activeIndex+1}) > span`);r.style.transform="translateX(0%)",r.style.transitionDuration=`${A}ms`},L=e=>{w(e),x(e),b=new Date().getTime();let t=e.el.querySelector(".stories-slider-pagination-bullet-current");t&&t.classList.remove("stories-slider-pagination-bullet-current");let i=e.el.querySelector(`.stories-slider-pagination-bullet:nth-child(${e.activeIndex+1})`),r=e.slides[e.activeIndex].querySelector("video");if(r){r.currentTime=0;try{h=requestAnimationFrame(()=>{r.play()})}catch(s){}}e.slides.forEach(e=>{e.querySelectorAll("video").forEach(e=>{e!==r&&(e.currentTime=0,cancelAnimationFrame(h),e.pause())})}),$.filter((e,t)=>t!==f).forEach(e=>{e.el.querySelectorAll("video").forEach(e=>{cancelAnimationFrame(h),e.pause()})});let n=[...i.parentElement.children],l=[...n].filter((e,t)=>t<n.indexOf(i)),o=[...n].filter((e,t)=>t>n.indexOf(i));l.forEach(e=>{e.classList.add("stories-slider-pagination-bullet-viewed"),e.querySelectorAll("span").forEach(e=>e.remove()),e.insertAdjacentHTML("beforeend","<span></span>")}),o.forEach(e=>{e.classList.remove("stories-slider-pagination-bullet-viewed","stories-slider-pagination-bullet-current"),e.querySelectorAll("span").forEach(e=>e.remove()),e.insertAdjacentHTML("beforeend","<span></span>")}),i.classList.remove("stories-slider-pagination-bullet-viewed"),i.classList.add("stories-slider-pagination-bullet-current"),[...i.children].forEach(e=>e.remove()),i.insertAdjacentHTML("beforeend","<span></span>"),i.clientWidth,i.querySelector("span").style.transform="translateX(0%)",i.querySelector("span").style.transitionDuration=`${A}ms`,d&&(cancelAnimationFrame(y),y=requestAnimationFrame(()=>{d(f,e.activeIndex)}))},I=e=>{let t=e.querySelectorAll(".swiper-slide"),i=document.createElement("div");i.classList.add("stories-slider-pagination");for(let r=0;r<t.length;r+=1){let s=document.createElement("div");s.classList.add("stories-slider-pagination-bullet"),s.appendChild(document.createElement("span")),i.appendChild(s)}e.appendChild(i)},N=e=>{e.el.querySelectorAll(".stories-slider-pagination, .stories-slider-pagination-bullet").forEach(e=>e.remove())},M=(e,t)=>{let i=e.querySelectorAll(".swiper-slide");i.forEach(e=>{let i=document.createElement("div"),r=document.createElement("div");i.classList.add("stories-slider-button","stories-slider-button-prev"),r.classList.add("stories-slider-button","stories-slider-button-next"),e.appendChild(i),e.appendChild(r);let s=()=>{if(!(S>200)){if(t.isBeginning){v.slidePrev();return}t.slidePrev()}},n=()=>{if(!(S>200)){if(t.isEnd){v.slideNext();return}t.slideNext()}};i.addEventListener("click",s),r.addEventListener("click",n)})},O=e=>{e.el.querySelectorAll(".stories-slider-button").forEach(e=>e.remove())};(()=>{let e=()=>{t.classList.add("stories-slider-perspective")},i=()=>{t.classList.remove("stories-slider-perspective")};v=new o(n,{modules:void 0!==a&&s?[a]:[],effect:s?void 0:"cube",speed:500,threshold:5,cubeEffect:{shadow:!1},observer:!0,on:{transitionStart(){i()},sliderFirstMove(){i()},transitionEnd(){e()},init(t){t.params.resistanceRatio=.5,e()},slideChange(){let e=$[f];f=v.activeIndex;let t=$[f];w(e),x(t),L(t)}}})})();try{t.querySelectorAll(".swiper .swiper").forEach((e,t)=>{let i=new o(e,{speed:s?500:1,nested:!0,allowTouchMove:!1,observer:!0,on:{touchStart(e){m=!0,q=!1,E=new Date().getTime(),g=setTimeout(()=>{q=!0,T(e)},200)},touchEnd(e){clearTimeout(g),f===t&&m&&(S=new Date().getTime()-E,q&&_(e),q=!1,m=!1)},init(e){p&&(f!==t?w(e):requestAnimationFrame(()=>{L(e)}))},slideChange(e){L(e)}}});I(e),M(e,i),$.push(i)})}catch(B){console.log(B)}let C=()=>{p||$.forEach((e,t)=>{t===f&&L(e)})},k=()=>{p=!1,$.forEach((e,t)=>{e.el.querySelectorAll("video").forEach(e=>{cancelAnimationFrame(h),e.pause()}),t===f?T(e):w(e)})},P=()=>{v&&v.destroy&&v.destroy(),$.forEach(e=>{w(e),N(e),O(e),e.destroy&&e.destroy()})},j=(e,t)=>{if(v&&v.slideTo&&!v.destroyed&&v.slideTo(e,0),void 0!==t){let i=$[e];i.slideTo&&!i.destroyed&&(i.activeIndex===t?L(i):i.slideTo(t,0))}};return{el:t,mainSwiper:v,subSwipers:$,destroy:P,slideTo:j,enable:C,disable:k}}});
// Swiper Epyc Runner
function main(){let e=document.querySelector(".stories-slider");e.style.display="flex";let s=createStoriesSlider(e,{Swiper,autoplayDuration:5e3,enabled:!1});$("#stories-slider-wrapper")[0],document.querySelectorAll(".demo-stories a").forEach((t,i)=>{t.addEventListener("click",t=>{t.preventDefault(),e.classList.add("stories-slider-in"),s.enable(),s.slideTo(i,0)})}),e.addEventListener("click",t=>{t.target.matches(".stories-slider-close-button")&&(s.disable(),e.classList.add("stories-slider-out"))}),e.addEventListener("animationend",()=>{e.classList.contains("stories-slider-out")&&(e.classList.remove("stories-slider-in"),e.classList.remove("stories-slider-out"))}),window.hasOwnProperty("storiesLoaded")&&(window.storiesLoaded=!0)}$(document).ready(function(){window.storiesLoaded||main()});
